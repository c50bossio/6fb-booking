(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[702],{8062:function(e,s,t){Promise.resolve().then(t.bind(t,1720))},1720:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var a=t(7437),i=t(2265),l=t(6070),n=t(2869),r=t(9179),d=t(3022),c=t(7500),o=t(297),x=t(2252),m=t(1239),h=t(5252),u=t(8896),j=t(525),g=t(4401),f=t(6221),v=t(5302),N=t(5805);function p(){var e,s;let{user:t}=(0,r.aC)(),[p,b]=(0,i.useState)(!1),{data:y,isLoading:w,error:k}=(0,o.GB)(),{data:Z,isLoading:B,error:R}=(0,o.tj)(null==y?void 0:null===(e=y[0])||void 0===e?void 0:e.id),{data:F,isLoading:S,error:O}=(0,o.uL)((null==y?void 0:null===(s=y[0])||void 0===s?void 0:s.id)||""),_=async()=>{b(!0);try{await new Promise(e=>setTimeout(e,3e3))}catch(e){console.error("Attribution processing failed:",e)}finally{b(!1)}},A={totalSpend:(null==Z?void 0:Z.reduce((e,s)=>e+(s.spent||0),0))||0,totalBookings:(null==F?void 0:F.length)||0,attributedBookings:(null==F?void 0:F.filter(e=>e.confidence>50).length)||0,totalRevenue:(null==F?void 0:F.reduce((e,s)=>e+(s.revenue||0),0))||0,attributedRevenue:(null==F?void 0:F.filter(e=>e.confidence>50).reduce((e,s)=>e+(s.revenue||0),0))||0,costPerBooking:0,roi:0,attributionRate:0};return(A.totalBookings>0&&(A.costPerBooking=A.totalSpend/A.totalBookings,A.attributionRate=A.attributedBookings/A.totalBookings*100),A.totalSpend>0&&(A.roi=(A.attributedRevenue-A.totalSpend)/A.totalSpend*100),w||B||S)?(0,a.jsx)(d.kI,{}):k||void 0===Z&&R?(0,a.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(x.Z,{className:"w-12 h-12 text-red-500 mx-auto"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Failed to load dashboard data"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Please check your connection and try again."})]}),(0,a.jsx)(n.z,{onClick:()=>window.location.reload(),variant:"outline",children:"Retry"})]})}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h1",{className:"text-3xl font-bold text-gray-900",children:["Welcome back, ",null==t?void 0:t.first_name,"! \uD83D\uDC4B"]}),(0,a.jsx)("p",{className:"text-gray-600 mt-1",children:"Here's what's happening with your attribution tracking today."})]}),(0,a.jsx)(n.z,{onClick:_,disabled:p,className:"flex items-center",children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.Z,{className:"mr-2 h-4 w-4"}),"Process Attribution"]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ll,{className:"text-sm font-medium",children:"Total Ad Spend"}),(0,a.jsx)(h.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",A.totalSpend.toFixed(2)]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[(null==Z?void 0:Z.length)||0," active campaigns"]})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ll,{className:"text-sm font-medium",children:"Attribution Rate"}),(0,a.jsx)(u.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[A.attributionRate.toFixed(1),"%"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[A.attributedBookings," of ",A.totalBookings," bookings"]})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ll,{className:"text-sm font-medium",children:"Average ROI"}),(0,a.jsx)(j.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[A.roi.toFixed(1),"%"]}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:["$",A.attributedRevenue.toFixed(2)," attributed revenue"]})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(l.ll,{className:"text-sm font-medium",children:"Cost per Booking"}),(0,a.jsx)(g.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(l.aY,{children:[(0,a.jsxs)("div",{className:"text-2xl font-bold",children:["$",A.costPerBooking.toFixed(2)]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Average cost per booking"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsxs)(l.Zb,{className:"lg:col-span-2",children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center",children:[(0,a.jsx)(f.Z,{className:"mr-2 h-5 w-5"}),"Top Performing Campaigns"]}),(0,a.jsx)(l.SZ,{children:"Your best campaigns based on ROI and attribution"})]}),(0,a.jsx)(l.aY,{children:B?(0,a.jsx)(c.o,{text:"Loading campaigns..."}):Z&&Z.length>0?(0,a.jsx)("div",{className:"space-y-4",children:Z.slice(0,3).map((e,s)=>{var t;let i=(null==F?void 0:F.filter(s=>s.campaign_id===e.id).length)||0,l=(null==F?void 0:F.filter(s=>s.campaign_id===e.id).reduce((e,s)=>e+(s.revenue||0),0))||0,n=e.spent>0?(l-e.spent)/e.spent*100:0;return(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("h4",{className:"font-medium",children:e.name}),(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("active"===e.status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:e.status})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 mt-1",children:[e.platform," • ",i," bookings • $",null===(t=e.spent)||void 0===t?void 0:t.toFixed(2)," spent"]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"text-lg font-semibold ".concat(n>=0?"text-green-600":"text-red-600"),children:[n.toFixed(1),"% ROI"]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["$",l.toFixed(2)," revenue"]})]})]},e.id)})}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(f.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No campaigns found"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Connect an advertising platform to see campaign performance"})]})})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsxs)(l.ll,{className:"flex items-center",children:[(0,a.jsx)(g.Z,{className:"mr-2 h-5 w-5"}),"Recent Activity"]}),(0,a.jsx)(l.SZ,{children:"Latest attribution and tracking events"})]}),(0,a.jsx)(l.aY,{children:S?(0,a.jsx)(c.o,{text:"Loading activity..."}):F&&F.length>0?(0,a.jsx)("div",{className:"space-y-4",children:F.slice(0,4).map(e=>{var s;let t=new Date(e.created_at).toLocaleString(),i=null==Z?void 0:Z.find(s=>s.id===e.campaign_id);return(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:(0,a.jsx)(v.Z,{className:"w-4 h-4 text-green-600"})})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-900",children:["New booking attributed to ",(null==i?void 0:i.name)||"campaign"]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:t}),(0,a.jsxs)("span",{className:"text-xs font-medium text-blue-600",children:["$",(null===(s=e.revenue)||void 0===s?void 0:s.toFixed(2))||"0.00"]})]})]})]},e.id)})}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(g.Z,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-500",children:"No recent activity"}),(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"Attribution events will appear here"})]})})]})]}),(0,a.jsxs)(l.Zb,{children:[(0,a.jsxs)(l.Ol,{children:[(0,a.jsx)(l.ll,{children:"Quick Actions"}),(0,a.jsx)(l.SZ,{children:"Get started with common tasks and setup"})]}),(0,a.jsx)(l.aY,{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)(n.z,{variant:"outline",className:"h-auto p-4 flex flex-col items-start",children:[(0,a.jsx)(N.Z,{className:"h-6 w-6 mb-2"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"font-medium",children:"Add Business"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Set up a new barbershop"})]})]}),(0,a.jsxs)(n.z,{variant:"outline",className:"h-auto p-4 flex flex-col items-start",children:[(0,a.jsx)(m.Z,{className:"h-6 w-6 mb-2"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"font-medium",children:"Connect Platform"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Integrate Facebook or Google"})]})]}),(0,a.jsxs)(n.z,{variant:"outline",className:"h-auto p-4 flex flex-col items-start",children:[(0,a.jsx)(f.Z,{className:"h-6 w-6 mb-2"}),(0,a.jsxs)("div",{className:"text-left",children:[(0,a.jsx)("div",{className:"font-medium",children:"View Reports"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"Detailed analytics dashboard"})]})]})]})})]})]})}}},function(e){e.O(0,[216,592,971,744],function(){return e(e.s=8062)}),_N_E=e.O()}]);