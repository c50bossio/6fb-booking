# Render Deployment Checklist for 6FB Booking Platform

## Pre-Deployment Setup

### 1. Environment Configuration
- [ ] Create Render account and project
- [ ] Set up PostgreSQL database on Render
- [ ] Configure all required environment variables in Render dashboard:
  - [ ] `DATABASE_URL` (auto-generated by Render)
  - [ ] `SECRET_KEY` (use Render's generate feature)
  - [ ] `JWT_SECRET_KEY` (use Render's generate feature)
  - [ ] `ENCRYPTION_KEY` (use Render's generate feature)
  - [ ] `STRIPE_SECRET_KEY`
  - [ ] `STRIPE_PUBLISHABLE_KEY`
  - [ ] `STRIPE_WEBHOOK_SECRET`
  - [ ] `STRIPE_CONNECT_CLIENT_ID`
  - [ ] `SENDGRID_API_KEY`
  - [ ] `FROM_EMAIL`
  - [ ] `GOOGLE_CLIENT_ID`
  - [ ] `GOOGLE_CLIENT_SECRET`
  - [ ] `GOOGLE_CALENDAR_API_KEY`

### 2. Repository Setup
- [ ] Ensure all files are committed to Git
- [ ] Push latest changes to GitHub/GitLab
- [ ] Verify render.yaml is in the root directory
- [ ] Confirm Python version files are present:
  - [ ] `/backend/.python-version` (3.11.9)
  - [ ] `/backend/runtime.txt` (python-3.11.9)

### 3. Database Preparation
- [ ] Test database migrations locally
- [ ] Backup any existing production data
- [ ] Prepare seed data scripts if needed

## Deployment Process

### 1. Initial Deployment
1. Connect Render to your Git repository
2. Select the render.yaml blueprint
3. Review and confirm all services:
   - Backend API service
   - Frontend Next.js service
   - PostgreSQL database
4. Deploy all services

### 2. Post-Deployment Verification
- [ ] Check backend health endpoint: `https://your-backend.onrender.com/api/v1/health`
- [ ] Verify database migrations ran successfully
- [ ] Test authentication endpoints
- [ ] Confirm frontend is accessible
- [ ] Verify API connectivity from frontend

### 3. Production Testing
- [ ] Run deployment health check:
  ```bash
  curl https://your-backend.onrender.com/api/v1/health
  ```
- [ ] Test critical user flows:
  - [ ] User registration
  - [ ] User login
  - [ ] Appointment booking
  - [ ] Payment processing (if configured)
  - [ ] Email notifications (if configured)

### 4. Monitoring Setup
- [ ] Configure Render's built-in monitoring
- [ ] Set up alert notifications
- [ ] Enable auto-deploy (optional)
- [ ] Configure custom domains (if applicable)

## Troubleshooting

### Common Issues and Solutions

1. **Build Failures**
   - Check Python version compatibility
   - Verify all dependencies in requirements.txt
   - Review build logs for specific errors

2. **Database Connection Issues**
   - Confirm DATABASE_URL is correctly set
   - Check database firewall/access rules
   - Verify migrations completed successfully

3. **Import Errors**
   - Ensure all Python packages are in requirements.txt
   - Check for version conflicts
   - Verify PYTHONPATH settings

4. **Performance Issues**
   - Adjust worker count in gunicorn command
   - Monitor memory usage
   - Consider upgrading Render plan if needed

## Rollback Procedure

If issues occur:
1. Use Render's deployment history to rollback
2. Restore database from backup if needed
3. Review logs to identify root cause
4. Fix issues in development environment
5. Re-deploy after testing

## Files Created/Modified for Render Deployment

1. **render.yaml** - Main deployment configuration
2. **backend/.python-version** - Python version specification
3. **backend/runtime.txt** - Render Python runtime
4. **backend/build.sh** - Build script
5. **backend/render-build.sh** - Render-specific build script
6. **backend/Procfile** - Process configuration
7. **backend/pyproject.toml** - Python project configuration
8. **backend/scripts/pre-deploy.sh** - Pre-deployment checks
9. **backend/scripts/deployment-health-check.py** - Health validation
10. **Updated backend/requirements.txt** - Added production dependencies

## Next Steps

1. Follow this checklist for deployment
2. Monitor application performance
3. Set up regular backups
4. Plan for scaling as needed
5. Implement CI/CD pipeline for automated deployments
